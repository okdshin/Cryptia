#ifdef CTRMODE_UNIT_TEST
#include "CtrMode.h"
#include <iostream>
#include "Aes.h"

using namespace cryptia;
using namespace cryptia::code;

int main(int argc, char* argv[])
{
	auto aes = Aes::Create();
	CtrMode ctr_mode(aes);
	auto data = ByteArray({
		0x6b, 0xc1, 0xbe, 0xe2, 0x2e, 0x40, 0x9f, 0x96, 
		0xe9, 0x3d, 0x7e, 0x11, 0x73, 0x93, 0x17, 0x2a	
	});
	auto key = ByteArray({
		0x2b, 0x7e, 0x15, 0x16, 0x28, 0xae, 0xd2, 0xa6, 
		0xab, 0xf7, 0x15, 0x88, 0x09, 0xcf, 0x4f, 0x3c
	});
	auto counter = ByteArray({
		0xf0, 0xf1, 0xf2, 0xf3, 0xf4, 0xf5, 0xf6, 0xf7,
		0xf8, 0xf9, 0xfa, 0xfb, 0xfc, 0xfd, 0xfe, 0xff
	});
	auto encrypted = ctr_mode.EncryptAndDecrypt(data, key, counter);
	OutputHex(std::cout << "encrypted: ", encrypted);
	std::cout << std::endl;
	auto decrypted = ctr_mode.EncryptAndDecrypt(encrypted, key, counter);
	OutputHex(std::cout << "decrypted: ", decrypted);

    return 0;
}

#endif
